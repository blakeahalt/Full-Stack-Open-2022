{"ast":null,"code":"import _objectSpread from\"/Users/blakeahalt/Documents/GitHub/Full-Stack-Open-2022/fullstackopen/src/part5/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/blakeahalt/Documents/GitHub/Full-Stack-Open-2022/fullstackopen/src/part5/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/blakeahalt/Documents/GitHub/Full-Stack-Open-2022/fullstackopen/src/part5/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/blakeahalt/Documents/GitHub/Full-Stack-Open-2022/fullstackopen/src/part5/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useRef}from'react';import'./index.css';import Note from'./components/Note';import Notification from'./components/Notification';import Footer from'./components/Footer';import LoginForm from'./components/LoginForm';import NoteForm from'./components/NoteForm';import Togglable from'./components/Togglable';import noteService from'./services/notes';import loginService from'./services/login';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),notes=_useState2[0],setNotes=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),showAll=_useState4[0],setShowAll=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),username=_useState8[0],setUsername=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),password=_useState10[0],setPassword=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),user=_useState12[0],setUser=_useState12[1];var noteFormRef=useRef();useEffect(function(){noteService.getAll().then(function(initialNotes){setNotes(initialNotes);});},[]);useEffect(function(){var loggedUserJSON=window.localStorage.getItem('loggedNoteappUser');if(loggedUserJSON){var _user=JSON.parse(loggedUserJSON);setUser(_user);noteService.setToken(_user.token);}},[]);var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var _user2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return loginService.login({username:username,password:password});case 4:_user2=_context.sent;window.localStorage.setItem('loggedNoteappUser',JSON.stringify(_user2));noteService.setToken(_user2.token);setUser(_user2);setUsername('');setPassword('');console.log('logging in with',username,password);_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);setErrorMessage('Wrong credentials');setTimeout(function(){setErrorMessage(null);},5000);case 17:case\"end\":return _context.stop();}},_callee,null,[[1,13]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();var handleLogOut=function handleLogOut(e){e.preventDefault();window.localStorage.clear();setUser(null);};var addNote=function addNote(noteObject){noteFormRef.current.toggleVisibility();noteService.create(noteObject).then(function(returnedNote){setNotes(notes.concat(returnedNote));noteFormRef.current.toggleVisibility();});};// const addNote = (event) => {\n//   event.preventDefault()\n//   noteFormRef.current.toggleVisibility()\n//   const noteObject = {\n//       content: newNote,\n//       date: new Date().toISOString(),\n//       important: Math.random() > 0.5,\n//       id: notes.length + 1,\n//     }\n//   noteService\n//   .create(noteObject)\n//   .then(returnedNote => {     \n//     setNotes(notes.concat(returnedNote))\n//     setNewNote('')\n//   })\n// }\n// const addNote = (event) => {\n//   event.preventDefault()\n// const noteObject = {\n//   content: newNote,\n//   date: new Date().toISOString(),\n//   important: Math.random() > 0.5,\n//   id: notes.length + 1,\n// }\n//   noteService\n//     .create(noteObject)\n//     .then(returnedNote => {\n//       setNotes(notes.concat(returnedNote))\n//       setNewNote('')\n//     })\n// }\n// const handleNoteChange = (event) => {\n//   setNewNote(event.target.value)\n// }\nvar toggleImportanceOf=function toggleImportanceOf(id){var note=notes.find(function(n){return n.id===id;});var changedNote=_objectSpread(_objectSpread({},note),{},{important:!note.important});noteService.update(id,changedNote).then(function(returnedNote){setNotes(notes.map(function(note){return note.id!==id?note:returnedNote;}));}).catch(function(){setErrorMessage(\"Note '\".concat(note.content,\"' was already removed from server\"));setTimeout(function(){setErrorMessage(null);},5000);setNotes(notes.filter(function(n){return n.id!==id;}));});};var noteForm=function noteForm(){return/*#__PURE__*/_jsx(Togglable,{buttonLabel:\"new note\",ref:noteFormRef,children:/*#__PURE__*/_jsx(NoteForm,{createNote:addNote})});};// const NoteForm = ({ onSubmit, handleChange, value}) => {\n//   return (\n//     <div>\n//       <h2>Create a new note</h2>\n//       <form onSubmit={onSubmit}>\n//         <input\n//           value={value}\n//           onChange={handleChange}\n//         />\n//         <button type=\"submit\">save</button>\n//       </form>\n//     </div>\n//   )\n// }\n// const noteForm = () => (\n//   <form onSubmit={addNote}>\n//     <input\n//       value={newNote}\n//       onChange={handleNoteChange}\n//     />\n//     <button type=\"submit\">save</button>\n//   </form>  \n// )\nvar notesToShow=showAll?notes:notes.filter(function(note){return note.important;});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Notes\"}),/*#__PURE__*/_jsx(Notification,{message:errorMessage}),user===null?/*#__PURE__*/_jsx(Togglable,{buttonLabel:\"login\",children:/*#__PURE__*/_jsx(LoginForm,{username:username,password:password,handleUsernameChange:function handleUsernameChange(_ref2){var target=_ref2.target;return setUsername(target.value);},handlePasswordChange:function handlePasswordChange(_ref3){var target=_ref3.target;return setPassword(target.value);},handleSubmit:handleLogin})}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[user.name,\" logged in\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogOut,children:\"Logout\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:10},children:/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return setShowAll(!showAll);},children:[\"show \",showAll?'important':'all']})}),/*#__PURE__*/_jsx(\"ul\",{children:notesToShow.map(function(note){return/*#__PURE__*/_jsx(Note,{note:note,toggleImportance:toggleImportanceOf},note.id);})}),noteForm(),/*#__PURE__*/_jsx(Footer,{})]});};export default App;","map":{"version":3,"names":["useState","useEffect","useRef","Note","Notification","Footer","LoginForm","NoteForm","Togglable","noteService","loginService","App","notes","setNotes","showAll","setShowAll","errorMessage","setErrorMessage","username","setUsername","password","setPassword","user","setUser","noteFormRef","getAll","then","initialNotes","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","handleLogin","event","preventDefault","login","setItem","stringify","console","log","setTimeout","handleLogOut","e","clear","addNote","noteObject","current","toggleVisibility","create","returnedNote","concat","toggleImportanceOf","id","note","find","n","changedNote","important","update","map","catch","content","filter","noteForm","notesToShow","target","value","name","marginTop"],"sources":["/Users/blakeahalt/Documents/GitHub/Full-Stack-Open-2022/fullstackopen/src/part5/src/App.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react'\nimport './index.css'\n\nimport Note from './components/Note'\nimport Notification from './components/Notification'\nimport Footer from './components/Footer'\nimport LoginForm from './components/LoginForm'\nimport NoteForm from './components/NoteForm'\nimport Togglable from './components/Togglable'\nimport noteService from './services/notes'\nimport loginService from './services/login'\n\n\nconst App = () => {\n  const [notes, setNotes] = useState([])\n  const [showAll, setShowAll] = useState(true)\n  const [errorMessage, setErrorMessage] = useState(null)\n  const [username, setUsername] = useState('') \n  const [password, setPassword] = useState('') \n  const [user, setUser] = useState(null)\n\n  const noteFormRef = useRef()\n\n  useEffect(() => {\n    noteService\n      .getAll()\n      .then(initialNotes => {\n        setNotes(initialNotes)\n      })\n  }, [])\n\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedNoteappUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      setUser(user)\n      noteService.setToken(user.token)\n    }\n  }, [])\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username, password,\n      })\n\n      window.localStorage.setItem(\n        'loggedNoteappUser', JSON.stringify(user)\n      ) \n      noteService.setToken(user.token)\n      setUser(user)\n      setUsername('')\n      setPassword('')\n      console.log('logging in with', username, password)\n    } catch {\n      setErrorMessage('Wrong credentials')\n      setTimeout(() => {\n        setErrorMessage(null)\n      }, 5000)\n    }\n  }\n\n  const handleLogOut =(e) => {\n    e.preventDefault()\n    window.localStorage.clear()\n    setUser(null)\n  }\n\n  const addNote = (noteObject) => {\n    noteFormRef.current.toggleVisibility()\n    noteService\n      .create(noteObject)\n      .then(returnedNote => {\n        setNotes(notes.concat(returnedNote))\n        noteFormRef.current.toggleVisibility()\n      })\n  }\n  // const addNote = (event) => {\n  //   event.preventDefault()\n  //   noteFormRef.current.toggleVisibility()\n  //   const noteObject = {\n  //       content: newNote,\n  //       date: new Date().toISOString(),\n  //       important: Math.random() > 0.5,\n  //       id: notes.length + 1,\n  //     }\n  //   noteService\n  //   .create(noteObject)\n  //   .then(returnedNote => {     \n  //     setNotes(notes.concat(returnedNote))\n  //     setNewNote('')\n  //   })\n  // }\n  // const addNote = (event) => {\n  //   event.preventDefault()\n    // const noteObject = {\n    //   content: newNote,\n    //   date: new Date().toISOString(),\n    //   important: Math.random() > 0.5,\n    //   id: notes.length + 1,\n    // }\n  //   noteService\n  //     .create(noteObject)\n  //     .then(returnedNote => {\n  //       setNotes(notes.concat(returnedNote))\n  //       setNewNote('')\n  //     })\n  // }\n\n  // const handleNoteChange = (event) => {\n  //   setNewNote(event.target.value)\n  // }\n\n  const toggleImportanceOf = id => {\n    const note = notes.find(n => n.id === id)\n    const changedNote = { ...note, important: !note.important }\n  \n    noteService\n      .update(id, changedNote)\n      .then(returnedNote => {\n        setNotes(notes.map(note => note.id !== id ? note : returnedNote))\n      })\n      .catch(() => {\n        setErrorMessage(\n          `Note '${note.content}' was already removed from server`\n        )\n        setTimeout(() => {\n          setErrorMessage(null)\n        }, 5000)\n        setNotes(notes.filter(n => n.id !== id))\n      })\n  }\n\n  const noteForm = () => (\n    <Togglable buttonLabel='new note' ref={noteFormRef}>\n      <NoteForm createNote={addNote} />\n    </Togglable>\n  )\n  // const NoteForm = ({ onSubmit, handleChange, value}) => {\n  //   return (\n  //     <div>\n  //       <h2>Create a new note</h2>\n  \n  //       <form onSubmit={onSubmit}>\n  //         <input\n  //           value={value}\n  //           onChange={handleChange}\n  //         />\n  //         <button type=\"submit\">save</button>\n  //       </form>\n  //     </div>\n  //   )\n  // }\n\n  // const noteForm = () => (\n  //   <form onSubmit={addNote}>\n  //     <input\n  //       value={newNote}\n  //       onChange={handleNoteChange}\n  //     />\n  //     <button type=\"submit\">save</button>\n  //   </form>  \n  // )\n\n  const notesToShow = showAll\n    ? notes\n    : notes.filter(note => note.important)\n\n  return (\n    <div>\n      <h1>Notes</h1>\n      <Notification message={errorMessage} />\n\n      {user === null ?\n        <Togglable buttonLabel='login'>\n          <LoginForm\n            username={username}\n            password={password}\n            handleUsernameChange={({ target }) => setUsername(target.value)}\n            handlePasswordChange={({ target }) => setPassword(target.value)}\n            handleSubmit={handleLogin}\n          />\n        </Togglable> :\n      <div>\n        <p>{user.name} logged in</p>\n        <button onClick={handleLogOut}>Logout</button>\n      </div>\n    }\n\n      <div style={{marginTop: 10}}>\n        <button onClick={() => setShowAll(!showAll)}>\n          show {showAll ? 'important' : 'all' }\n        </button>\n      </div>   \n      <ul>\n        {notesToShow.map(note => \n          <Note\n            key={note.id}\n            note={note}\n            toggleImportance={toggleImportanceOf}\n          />\n        )}\n      </ul>\n        {noteForm()}\n\n      <Footer />\n    </div>\n  )\n}\n\nexport default App"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}